\chapter{Аналитический раздел}

Каждая редакционная операция имеет свой штраф, который определяет стоимость данной операции. В общем случае:
\begin{itemize}
	\item $ m(a, b) $ --- цена замены символа $ a $ на $ b $, при $ a \ne b $;
	\item $ m(\lambda, a) $ --- цена вставки символа $ a $;
	\item $ m(a, \lambda) $ --- цена удаления символа $ a $.
\end{itemize}


\section{Расстояние Левенштейна}

При вычислении расстояния Левенштейна будем считать стоимость каждой редакционной операции равной $ 1 $, при этом, если символы совпадают, то штраф равен $0$, т.~е.:
\begin{itemize}
	\item $ m(a, b) = 1 $;
	\item $ m(\lambda, a) = 1 $;
	\item $ m(a, \lambda) = 1 $;
	\item $ m(a, a) = 0 $.
\end{itemize}

Пусть $S_1$ и $S_2$ --- две строки (длинной $M$ и $N$ соответственно) над некоторым алфавитом, тогда расстояние Левенштейна можно вычислить по следующей рекуррентной формуле \eqref{eq:L}.

\begin{equation}
	\label{eq:L}
	D(i,j) = \left\{ \begin{array}{ll}
		0, & \textrm{$i = 0, j = 0$}\\
		i, & \textrm{$j = 0, i > 0$}\\
		j, & \textrm{$i = 0, j > 0$}\\
		min(\\
		D(i,j-1)+1,\\
		D(i-1, j) +1, &\textrm{$j>0, i>0$}\\
		D(i-1, j-1) + m(S_{1}[i], S_{2}[j])\\
		),
	\end{array} \right.
\end{equation}

Значение $ m(a, b) $ можно рассчитать по формуле \eqref{eq:m}.
\begin{equation}
	\label{eq:m}
	m(a, b) = \begin{cases}
		0, &\text{если a = b}\\
		1, &\text{иначе}
	\end{cases}
\end{equation}

\textbf{Нерекурсивный алгоритм нахождения расстояния Левенштейна}

Прямая реализация формулы \eqref{eq:L} малоэффективна, поскольку множество промежуточных значений вычисляются несколько раз. Используя матрицу $ A_{(M+1) \times (N+1)} $ для хранения промежуточных значений, сведем задачу к итерационному заполнению матрицы $ A_{(M+1) \times (N+1)} $ значениями $ D(i, j) $. Т.~о. значение в ячейке $ [i, j] $ равно значению $ D(S_1[1...i], S_2[1...j]) $.

\section{Расстояние Дамерау---Левенштейна}

Расстояние Дамерау---Левенштейна модифицирует расстояние Левенштейна, добавляя ко всем перечисленным операциям, операцию перестановки соседних символов. Штраф новой операции также составляет $ 1 $. 

Расстояние Дамерау---Левенштейна может быть вычислено по рекуррентной формуле \eqref{eq:DL}.

\begin{equation}
	\label{eq:DL}
	D(i, j) = 
	\begin{cases}
		0, &\text{i = 0, j = 0,}\\
		i, &\text{j = 0, i > 0,}\\
		j, &\text{i = 0, j > 0,}\\
		min(\\
		D(i, j - 1) + 1,\\
		D(i - 1, j) + 1,\\ 
		D(i - 1, j - 1) + m(S_{1}[i], S_{2}[j]), \\
		\begin{cases}
			D(i - 2, j - 2) + 1, & \begin{aligned}
				& \text{если i > 1, j > 1}, \\
				& S_{1}[i] = S_{2}[j - 1], \\
				& S_{1}[i - 1] = S_{2}[j], \\
			\end{aligned}\\
			\infty, & \textrm{иначе} \\
		\end{cases} \\
		), & \textrm{иначе.}
	\end{cases}
\end{equation}

\textbf{Рекурсивный алгоритм нахождения расстояния Дамерау---Левенштейна с кешем}

Используя кеш, рекурсивный алгоритм вычисления расстояния по формуле \eqref{eq:DL} можно оптимизировать по времени выполнения.  В качестве кеша используется матрица. Суть данной оптимизации заключается в сокращении числа лишних операций, производимых над одними и теми же подстроками несколько раз. В случае, если для текущих подстрок, значение расстояния отсутствует в кеше, то оно вычисляется с помощью рекурсивного алгоритма и заносится в матрицу. Если же значение присутствует в кеше, то алгоритм сразу переходит к следующему шагу.

\textbf{Нерекурсивный алгоритм нахождения расстояния Дамерау---Левенштейна}

Можно свести задачу вычисления расстояния Дамерау---Левенштейна к итерационному заполнению матрицы промежуточными значениями $D(i, j)$. При этом матрица будет иметь размер $(M+1) \times (N+1)$.

\subsection*{Вывод}
В данном разделе были рассмотрены алгоритмы нахождения расстояний Левенштейна и Дамерау---Левенштейна, поскольку данные расстояния могут быть вычислены с помощью рекуррентных формул, то алгоритмы могут быть реализованы рекурсивно и итеративно. 


